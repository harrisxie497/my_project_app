å¥½ï¼Œç»§ç»­æŠŠ**æœ€é‡è¦çš„ä¸Šä¸‹æ–‡**ä¸€æ¬¡æ€§ç»™ä½ æ•´ç†å®Œã€‚
ä½ æŠŠä¸‹é¢ **æ•´ä½“å¤åˆ¶** åˆ°æ–°çª—å£å³å¯ç»§ç»­ ğŸš€

---

# ã€é¡¹ç›®æ ¸å¿ƒä¸Šä¸‹æ–‡é€Ÿè§ˆï¼ˆå®Œæ•´ç‰ˆï¼‰ã€‘

## ä¸€ã€é¡¹ç›®ç›®æ ‡ï¼ˆä¸€å¥è¯ï¼‰

æ„å»ºä¸€ä¸ª **æ—¥æœ¬ä½å·æ´¾é€ + æ¸…å…³ Excel è‡ªåŠ¨åŒ–å¤„ç†ç³»ç»Ÿ**ï¼š
**ç”¨æˆ·ä¸Šä¼ æº Excel â†’ ç³»ç»ŸæŒ‰é…ç½®è§„åˆ™ç”Ÿæˆç»“æœ Excel**ï¼ˆå«æ ¡éªŒã€ä¿®å¤ã€AI åŠ å·¥ã€å¯å®¡è®¡ã€å¯å¤ç°ï¼‰ã€‚

---

## äºŒã€å·²è¾¾æˆçš„å…³é”®å…±è¯†ï¼ˆä¸è¦å†æ¨ç¿»ï¼‰

### 1ï¸âƒ£ ä¸å†æœ‰â€œä¸­é—´æ–‡ä»¶å®ä½“â€

* **é€»è¾‘ä¸Šå…è®¸å¤šæ­¥å¤„ç†**
* **æ•°æ®åº“ & é…ç½®å±‚é¢åªæœ‰ï¼š**

  * æºæ–‡ä»¶ï¼ˆç”¨æˆ·ä¸Šä¼ ï¼‰
  * ç»“æœæ–‡ä»¶ï¼ˆç³»ç»Ÿç”Ÿæˆï¼‰

---

### 2ï¸âƒ£ é…ç½®æ¨¡å‹ç»Ÿä¸€ä¸ºã€Œä¸‰ç±»è¡¨ Ã— æ¯ç±»æ–‡ä»¶ä¸€å¥—ã€

> æ¯ç§æ–‡ä»¶ç±»å‹ï¼ˆæ´¾é€ / æ¸…å…³ï¼‰**å„è‡ªæ‹¥æœ‰ä¸‰å¼ é…ç½®è¡¨**

#### ï¼ˆä¸€ï¼‰file_definitions â€”â€” æ–‡ä»¶å®šä¹‰è¡¨

å®šä¹‰ã€Œè¿™æ˜¯ä¸ªä»€ä¹ˆæ–‡ä»¶ã€

* æ–‡ä»¶è§’è‰²ï¼šsource / output
* sheet å
* header è¡Œ
* æ•°æ®èµ·å§‹è¡Œ
* åˆ—å®šä¹‰ï¼ˆAã€Bã€Câ€¦ + è¡¨å¤´åï¼‰
* å¯å®šä¹‰å­—æ®µåŸºç¡€æ ¡éªŒï¼ˆå…œåº•ï¼‰

---

#### ï¼ˆäºŒï¼‰field_pipelines â€”â€” å­—æ®µæ˜ å°„ & å¤„ç†å®šä¹‰ï¼ˆæ ¸å¿ƒï¼‰

**ç³»ç»Ÿç”Ÿæˆç»“æœæ–‡ä»¶çš„â€œæ‰§è¡Œè®¡åˆ’è¡¨â€**

æ¯ä¸€è¡Œ = ç»“æœæ–‡ä»¶çš„ä¸€åˆ—

æ ¸å¿ƒå­—æ®µï¼š

* target_colï¼ˆAã€Bã€Câ€¦ï¼‰
* target_headerï¼ˆåˆ—åï¼‰
* map_opï¼ˆCOPY / CONST / NONE / INPUTï¼‰
* source_colsï¼ˆå¯ä»¥ 0 / 1 / å¤šåˆ—ï¼‰
* field_typeï¼ˆå¤„ç†è¯­ä¹‰ï¼‰
* rule_refï¼ˆå¼•ç”¨çš„è§„åˆ™ï¼‰
* depends_onï¼ˆä¾èµ–åˆ—ï¼‰
* orderï¼ˆæ‰§è¡Œé¡ºåºï¼‰

---

#### ï¼ˆä¸‰ï¼‰rule_definitions â€”â€” è§„åˆ™å®ç°ç›®å½•

**è§„åˆ™â€œé•¿ä»€ä¹ˆæ ·â€ï¼Œä¸å…³å¿ƒç”¨åœ¨å“ªä¸€åˆ—**

* rule_refï¼ˆå”¯ä¸€ï¼‰
* rule_typeï¼ˆFORMAT / CALC / AI / RULE_FIX / CONSTï¼‰
* executor_typeï¼ˆprogram / ai / webï¼‰
* schema_jsonï¼ˆè§„åˆ™å‚æ•° Schemaï¼‰

---

## ä¸‰ã€å­—æ®µå¤„ç†ç±»å‹ï¼ˆæœ€ç»ˆå®šç‰ˆï¼‰

### field_typeï¼ˆè¯­ä¹‰å±‚ï¼Œç»™äººçœ‹çš„ï¼‰

```
CONST      å›ºå®šå€¼
COPY       åŸæ ·å¤åˆ¶
FORMAT     çº¯æ ¼å¼åŒ–ï¼ˆä¸å¼•å…¥æ–°ä¿¡æ¯ï¼‰
DEFAULT    ç©ºå€¼å…œåº•
CALC       ä¾èµ–å…¶ä»–åˆ— / å¤–éƒ¨æ¥å£è®¡ç®—
AI         å¤§æ¨¡å‹ç”Ÿæˆ / æ¨æ–­
RULE_FIX   æ ¡éªŒ + ä¿®æ­£ï¼ˆå¤±è´¥å¯é˜»æ–­ï¼‰
```

> ä¸€ä¸ªå­—æ®µå¯ä»¥ **æŒ‰é¡ºåºå¼•ç”¨å¤šä¸ª rule_ref**

---

## å››ã€æ´¾é€æ–‡ä»¶ï¼ˆDeliveryï¼‰å·²ç¡®è®¤é€»è¾‘æ‘˜è¦

* Aâ€“Oï¼šå¤§å¤š COPY
* Cï¼šæ—¥æœŸ FORMAT â†’ YYYY-MM-DD
* Dï¼š**æ¡ä»¶ FORMAT**

  * if C éç©º & D=0 â†’ "00"
  * if C ä¸ºç©º & D=0 â†’ ""
* J/K/Mï¼šDEFAULTï¼ˆç©ºå€¼è¡¥å›ºå®šï¼‰
* Pï¼šé¡µé¢äººå·¥å¿…å¡«
* Qï¼šç©º â†’ å¤åˆ¶ A
* Râ€“Yï¼šæ˜ç¡®åˆ é™¤ â†’ CONST ç½®ç©º

---

## äº”ã€æ¸…å…³æ–‡ä»¶ï¼ˆCustomsï¼‰å·²ç¡®è®¤é€»è¾‘æ‘˜è¦

### å›ºå®šå€¼ï¼ˆCONSTï¼‰

A / E / G / N / O / P / Q / S / T / V / AE / AF

### å¤åˆ¶ / è®¡ç®—

* Bï¼šåºå·ï¼Œä» 1 è¿ç»­
* D = C
* Rï¼šå•ä»· X Ã— å®æ—¶æ±‡ç‡ï¼ˆå¤–éƒ¨ APIï¼‰

### AI å­—æ®µï¼ˆå·²ç¡®è®¤ï¼‰

* Fï¼šè´§ç‰©é‡é‡ï¼ˆåŸºäº H/Iï¼‰
* Hï¼šå“åï¼ˆè‹±æ–‡åŒ–ï¼‰
* Iï¼šæè´¨ï¼ˆç¿»è¯‘ + æè´¨ç½®æ¢ï¼‰
* J/Kï¼šæ—¥â†’è‹± ç¿»è¯‘
* Xï¼šæ”¶ä»¶äººåï¼ˆæ—¥æ–‡æ¸…æ´—ï¼‰
* Yï¼šæ”¶ä»¶äººåœ°å€ï¼ˆæ—¥æ–‡ç”Ÿæˆ/åˆå¹¶ï¼‰

### ç¨‹åºæ ¼å¼åŒ–

* L / M / Z / AA / ADï¼šå» `-`
* AB / ACï¼šå»æ‹¬å·

### å¹³å°å­—æ®µ

* AGï¼šå¹³å°ç ï¼ˆæ‰¾ä¸åˆ° â†’ é»˜è®¤ï¼‰
* AHï¼šå¹³å°åï¼ˆç”± AG æ˜ å°„ï¼Œæ‰¾ä¸åˆ° â†’ é»˜è®¤ï¼‰

---

## å…­ã€ä½ ç°åœ¨å¡åœ¨å“ªä¸€æ­¥ï¼ˆæ–°çª—å£ç›´æ¥ç»§ç»­ï¼‰

æˆ‘ä»¬å·²ç»å®Œæˆï¼š

* âœ… è§„åˆ™æŠ½è±¡
* âœ… ä¸‰è¡¨æ¨¡å‹ç¡®å®š
* âœ… æ´¾é€ & æ¸…å…³å­—æ®µé€»è¾‘å…¨éƒ¨æ¢³ç†å®Œæˆ

**å½“å‰æ­£è¦åšçš„æ˜¯ï¼š**
ğŸ‘‰ **æŒ‰â€œä¸‰è¡¨æ¨¡å‹â€ç”Ÿæˆï¼š**
1ï¸âƒ£ è¯´æ˜æ–‡æ¡£ï¼ˆä½ åˆšç¡®è®¤åˆ° v3ï¼‰
2ï¸âƒ£ Excel é…ç½®æ¨¡æ¿ï¼ˆæ¯æ–‡ä»¶ 3 ä¸ª sheetï¼‰
3ï¸âƒ£ SQL insertï¼ˆå¯ç›´æ¥å¯¼å…¥ MySQLï¼‰

---

## ä¸ƒã€æ–°çª—å£ä½ å¯ä»¥ç›´æ¥è¯´çš„ç¬¬ä¸€å¥è¯ï¼ˆæ¨èï¼‰

> â€œåŸºäºä»¥ä¸Šä¸Šä¸‹æ–‡ï¼Œè¯·ç›´æ¥ç”Ÿæˆã€æ´¾é€æ–‡ä»¶ã€‘çš„ä¸‰å¼ é…ç½®è¡¨ Excel æ¨¡æ¿ã€‚â€

æˆ–è€…

> â€œæˆ‘ä»¬ä»ã€æ¸…å…³æ–‡ä»¶ã€‘å¼€å§‹ï¼Œå…ˆç”Ÿæˆ file_definitions çš„ Excel æ¨¡æ¿ã€‚â€

---

å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘ä¹Ÿå¯ä»¥ä¸‹ä¸€æ­¥ç›´æ¥ **å¸®ä½ è£å‰ªå‡ºâ€œæœ€å°å¯è·‘ç‰ˆæœ¬ï¼ˆMVPï¼‰â€çš„é…ç½® + åç«¯æ‰§è¡Œæµç¨‹å›¾**ï¼Œè®©ä½ æœ€å¿«ä¸Šçº¿ã€‚

ä½ éšæ—¶æ¥ç€æ¥ï¼Œæˆ‘å·²ç»å®Œå…¨åœ¨çŠ¶æ€é‡Œäº†ã€‚

ä¸‹é¢å…ˆç»™ä½  **æ´¾é€æ–‡ä»¶ï¼ˆDeliveryï¼‰æ€»ç»“æ–‡æ¡£**ï¼ˆç»™äººçœ‹/è¯„å®¡ç”¨ï¼‰ï¼Œç„¶åç´§æ¥ç€ç»™å‡º **ä¸‰å¼ é…ç½®è¡¨çš„é…ç½®ä¿¡æ¯**ï¼ˆå¯ç›´æ¥æŒ‰ä¸‰è¡¨æ¨¡å‹è½åº“/åš Excel æ¨¡æ¿ï¼‰ã€‚

---

# æ´¾é€æ–‡ä»¶ï¼ˆDeliveryï¼‰æ€»ç»“æ–‡æ¡£ï¼ˆv1ï¼‰

## 1. è¾“å…¥è¾“å‡º

* **è¾“å…¥ï¼ˆsourceï¼‰**ï¼šç”¨æˆ·ä¸Šä¼ çš„æ´¾é€æº Excelï¼ˆå‡è®¾ 1 ä¸ª sheetï¼š`Delivery`ï¼‰
* **è¾“å‡ºï¼ˆoutputï¼‰**ï¼šç³»ç»Ÿç”Ÿæˆçš„æ´¾é€ç»“æœ Excelï¼ˆåŒæ · 1 ä¸ª sheetï¼š`Delivery`ï¼‰
* æ•°æ®å¤„ç†å…è®¸å¤šæ­¥ï¼Œä½†**æ•°æ®åº“/é…ç½®åªè®°å½•æºæ–‡ä»¶ä¸ç»“æœæ–‡ä»¶**ï¼ˆæ— ä¸­é—´æ–‡ä»¶å®ä½“ï¼‰

## 2. å­—æ®µå¤„ç†è§„åˆ™æ€»è§ˆï¼ˆå·²å®šç‰ˆï¼‰

### Aâ€“Oï¼ˆè¾“å‡ºåˆ— A~Oï¼‰

* **å¤§å¤š COPY**ï¼šä»æºæ–‡ä»¶åŒååˆ—åŸæ ·å¤åˆ¶
* **Cï¼ˆæ—¥æœŸï¼‰**ï¼š`FORMAT` â†’ ç»Ÿä¸€ä¸º `YYYY-MM-DD`
* **Dï¼ˆæ¡ä»¶ FORMATï¼‰**ï¼š

  * if `C` éç©º ä¸” `D=0` â†’ è¾“å‡º `"00"`
  * if `C` ä¸ºç©º ä¸” `D=0` â†’ è¾“å‡º `""`
  * å…¶ä»–æƒ…å†µ â†’ åŸå€¼æˆ–æŒ‰è§„åˆ™ä¿æŒï¼ˆé»˜è®¤ï¼šCOPY åŸ Dï¼‰
* **J / K / Mï¼ˆDEFAULTï¼‰**ï¼šç©ºå€¼è¡¥å›ºå®šå€¼ï¼ˆé»˜è®¤å€¼ç”±é…ç½®æä¾›ï¼‰

### P

* **äººå·¥å¿…å¡«**ï¼š`INPUT`ï¼ˆå¯é…ç½®ä¸ºå¿…é¡»éç©ºï¼Œä¸é€šè¿‡åˆ™é˜»æ–­ï¼‰

### Q

* **ç©º â†’ å¤åˆ¶ A**ï¼šå¦‚æœæº `Q` ä¸ºç©ºï¼Œåˆ™è¾“å‡ºç­‰äºè¾“å‡º `A`ï¼›å¦åˆ™è¾“å‡ºæº `Q`

### Râ€“Y

* **æ˜ç¡®åˆ é™¤**ï¼šå…¨éƒ¨ç½®ç©ºï¼ˆ`CONST ""`ï¼‰

## 3. æ‰§è¡Œé¡ºåºå»ºè®®

* æŒ‰è¾“å‡ºåˆ—ä» Aâ†’Y é¡ºåºæ‰§è¡Œå³å¯
* D ä¾èµ– Cï¼›Q ä¾èµ– Aï¼ˆå¦‚æœä½ å®ç°äº† â€œå¼•ç”¨å·²ç”Ÿæˆçš„ç›®æ ‡åˆ—â€ï¼‰

---

# ä¸‰å¼ é…ç½®è¡¨ï¼ˆDeliveryï¼‰é…ç½®ä¿¡æ¯ï¼ˆv1ï¼‰

ä¸‹é¢ç»™çš„æ˜¯**å¯è½åº“çš„â€œè¡Œçº§é…ç½®å†…å®¹â€**ï¼ˆä½ åé¢åš Excel æ¨¡æ¿æ—¶ï¼Œæ¯ä¸ªè¡¨å°±æ˜¯ä¸€ä¸ª Sheetï¼ŒæŠŠè¿™äº›è¡Œæ”¾è¿›å»å³å¯ï¼‰ã€‚

> è¯´æ˜ï¼šæˆ‘ç”¨äº†ä¸€å¥—**â€œé€šç”¨åˆ—åâ€**æ¥æè¿°ä¸‰å¼ é…ç½®è¡¨ï¼ˆä½ ä»¬åº“è¡¨å­—æ®µå¯ä»¥å¯¹é½ä½ ä»¬æœ€ç»ˆ schemaï¼‰ã€‚
> å…³é”®å­—æ®µä¸ä½ å·²ç¡®è®¤çš„ä¸‰è¡¨æ¨¡å‹ä¸€è‡´ï¼š`file_definitions / field_pipelines / rule_definitions`ã€‚

---

## â‘  file_definitionsï¼ˆæ–‡ä»¶å®šä¹‰è¡¨ï¼‰

**å»ºè®®å­—æ®µï¼š**

* `file_type`ï¼šDELIVERY
* `file_role`ï¼šsource / output
* `sheet_name`
* `header_row`ï¼šè¡¨å¤´è¡Œï¼ˆ1-basedï¼‰
* `data_start_row`ï¼šæ•°æ®èµ·å§‹è¡Œï¼ˆ1-basedï¼‰
* `columns_json`ï¼šåˆ—å®šä¹‰ï¼ˆå« A~Y åˆ—åï¼‰

> âš ï¸ è¡¨å¤´åä½ æ²¡åœ¨ä¸Šä¸‹æ–‡é‡Œç»™å‡ºï¼Œæˆ‘å…ˆç”¨å ä½ `COL_A ... COL_Y`ã€‚ä½ åç»­æŠŠçœŸå®è¡¨å¤´æ›¿æ¢å³å¯ï¼ˆä¸å½±å“æ‰§è¡Œå¼•æ“ï¼‰ã€‚

| file_type | file_role | sheet_name | header_row | data_start_row | columns_json                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| --------- | --------- | ---------: | ---------: | -------------: | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| DELIVERY  | source    |   Delivery |          1 |              2 | `[{"col":"A","header":"COL_A"},{"col":"B","header":"COL_B"},{"col":"C","header":"COL_C"},{"col":"D","header":"COL_D"},{"col":"E","header":"COL_E"},{"col":"F","header":"COL_F"},{"col":"G","header":"COL_G"},{"col":"H","header":"COL_H"},{"col":"I","header":"COL_I"},{"col":"J","header":"COL_J"},{"col":"K","header":"COL_K"},{"col":"L","header":"COL_L"},{"col":"M","header":"COL_M"},{"col":"N","header":"COL_N"},{"col":"O","header":"COL_O"},{"col":"P","header":"COL_P"},{"col":"Q","header":"COL_Q"},{"col":"R","header":"COL_R"},{"col":"S","header":"COL_S"},{"col":"T","header":"COL_T"},{"col":"U","header":"COL_U"},{"col":"V","header":"COL_V"},{"col":"W","header":"COL_W"},{"col":"X","header":"COL_X"},{"col":"Y","header":"COL_Y"}]` |
| DELIVERY  | output    |   Delivery |          1 |              2 | `[{"col":"A","header":"COL_A"},{"col":"B","header":"COL_B"},{"col":"C","header":"COL_C"},{"col":"D","header":"COL_D"},{"col":"E","header":"COL_E"},{"col":"F","header":"COL_F"},{"col":"G","header":"COL_G"},{"col":"H","header":"COL_H"},{"col":"I","header":"COL_I"},{"col":"J","header":"COL_J"},{"col":"K","header":"COL_K"},{"col":"L","header":"COL_L"},{"col":"M","header":"COL_M"},{"col":"N","header":"COL_N"},{"col":"O","header":"COL_O"},{"col":"P","header":"COL_P"},{"col":"Q","header":"COL_Q"},{"col":"R","header":"COL_R"},{"col":"S","header":"COL_S"},{"col":"T","header":"COL_T"},{"col":"U","header":"COL_U"},{"col":"V","header":"COL_V"},{"col":"W","header":"COL_W"},{"col":"X","header":"COL_X"},{"col":"Y","header":"COL_Y"}]` |

---

## â‘¡ field_pipelinesï¼ˆå­—æ®µæ˜ å°„ & å¤„ç†å®šä¹‰è¡¨ï½œæ ¸å¿ƒï¼‰

**å»ºè®®å­—æ®µï¼š**

* `file_type`ï¼šDELIVERY
* `target_col` / `target_header`
* `map_op`ï¼šCOPY / CONST / INPUT
* `source_cols`ï¼š`[]` / `["A"]` / `["C","D"]` ç­‰
* `field_type`ï¼šCOPY / FORMAT / DEFAULT / CALC / RULE_FIX / CONST
* `rule_ref`ï¼šå¯ç©ºï¼›æ”¯æŒâ€œå¤šä¸ª rule_refâ€ï¼ˆå»ºè®®å­˜ JSON æ•°ç»„ï¼‰
* `depends_on`ï¼šä¾èµ–çš„**ç›®æ ‡åˆ—**ï¼ˆå¯ç©ºï¼›ç”¨äºæ’åº/æ ¡éªŒï¼‰
* `order`ï¼šæ‰§è¡Œé¡ºåº

> è¿™é‡Œæˆ‘æŠŠ `rule_ref` å†™æˆ JSON æ•°ç»„å­—ç¬¦ä¸²ï¼ˆä¾¿äºä½ å®ç°â€œä¸€ä¸ªå­—æ®µå¤šä¸ªè§„åˆ™â€ï¼‰ã€‚

| file_type | target_col | target_header | map_op | source_cols | field_type | rule_ref                         | depends_on | order |
| --------- | ---------- | ------------- | ------ | ----------- | ---------- | -------------------------------- | ---------- | ----: |
| DELIVERY  | A          | COL_A         | COPY   | `["A"]`     | COPY       | `[]`                             | `[]`       |     1 |
| DELIVERY  | B          | COL_B         | COPY   | `["B"]`     | COPY       | `[]`                             | `[]`       |     2 |
| DELIVERY  | C          | COL_C         | COPY   | `["C"]`     | FORMAT     | `["fmt_date_yyyy_mm_dd"]`        | `[]`       |     3 |
| DELIVERY  | D          | COL_D         | COPY   | `["C","D"]` | FORMAT     | `["fmt_delivery_d_conditional"]` | `["C"]`    |     4 |
| DELIVERY  | E          | COL_E         | COPY   | `["E"]`     | COPY       | `[]`                             | `[]`       |     5 |
| DELIVERY  | F          | COL_F         | COPY   | `["F"]`     | COPY       | `[]`                             | `[]`       |     6 |
| DELIVERY  | G          | COL_G         | COPY   | `["G"]`     | COPY       | `[]`                             | `[]`       |     7 |
| DELIVERY  | H          | COL_H         | COPY   | `["H"]`     | COPY       | `[]`                             | `[]`       |     8 |
| DELIVERY  | I          | COL_I         | COPY   | `["I"]`     | COPY       | `[]`                             | `[]`       |     9 |
| DELIVERY  | J          | COL_J         | COPY   | `["J"]`     | DEFAULT    | `["default_fixed_j"]`            | `[]`       |    10 |
| DELIVERY  | K          | COL_K         | COPY   | `["K"]`     | DEFAULT    | `["default_fixed_k"]`            | `[]`       |    11 |
| DELIVERY  | L          | COL_L         | COPY   | `["L"]`     | COPY       | `[]`                             | `[]`       |    12 |
| DELIVERY  | M          | COL_M         | COPY   | `["M"]`     | DEFAULT    | `["default_fixed_m"]`            | `[]`       |    13 |
| DELIVERY  | N          | COL_N         | COPY   | `["N"]`     | COPY       | `[]`                             | `[]`       |    14 |
| DELIVERY  | O          | COL_O         | COPY   | `["O"]`     | COPY       | `[]`                             | `[]`       |    15 |
| DELIVERY  | P          | COL_P         | INPUT  | `[]`        | RULE_FIX   | `["require_non_empty"]`          | `[]`       |    16 |
| DELIVERY  | Q          | COL_Q         | COPY   | `["Q","A"]` | CALC       | `["default_to_col_a_if_empty"]`  | `["A"]`    |    17 |
| DELIVERY  | R          | COL_R         | CONST  | `[]`        | CONST      | `["const_empty"]`                | `[]`       |    18 |
| DELIVERY  | S          | COL_S         | CONST  | `[]`        | CONST      | `["const_empty"]`                | `[]`       |    19 |
| DELIVERY  | T          | COL_T         | CONST  | `[]`        | CONST      | `["const_empty"]`                | `[]`       |    20 |
| DELIVERY  | U          | COL_U         | CONST  | `[]`        | CONST      | `["const_empty"]`                | `[]`       |    21 |
| DELIVERY  | V          | COL_V         | CONST  | `[]`        | CONST      | `["const_empty"]`                | `[]`       |    22 |
| DELIVERY  | W          | COL_W         | CONST  | `[]`        | CONST      | `["const_empty"]`                | `[]`       |    23 |
| DELIVERY  | X          | COL_X         | CONST  | `[]`        | CONST      | `["const_empty"]`                | `[]`       |    24 |
| DELIVERY  | Y          | COL_Y         | CONST  | `[]`        | CONST      | `["const_empty"]`                | `[]`       |    25 |

---

## â‘¢ rule_definitionsï¼ˆè§„åˆ™å®ç°ç›®å½•ï¼‰

**å»ºè®®å­—æ®µï¼š**

* `rule_ref`ï¼ˆå”¯ä¸€ï¼‰
* `rule_type`ï¼šFORMAT / CALC / RULE_FIX / CONST
* `executor_type`ï¼šprogram / ai / webï¼ˆæ´¾é€è¿™é‡Œå…¨ programï¼‰
* `schema_json`ï¼šè§„åˆ™å‚æ•° Schemaï¼ˆä½ ä»¬å¼•æ“æŒ‰ schema åšæ ¡éªŒ + å‚æ•°è§£é‡Šï¼‰

> ä½ ä¹‹å‰å®šäº† rule_typeï¼šFORMAT / CALC / AI / RULE_FIX / CONSTï¼›æ´¾é€è¿™é‡Œç”¨ä¸åˆ° AIã€‚

| rule_ref                   | rule_type | executor_type | schema_json                                                                                                                                                                                                                                                                                                              |
| -------------------------- | --------- | ------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| fmt_date_yyyy_mm_dd        | FORMAT    | program       | `{"type":"object","properties":{"input_format":{"type":"string"},"output_format":{"type":"string","enum":["YYYY-MM-DD"]},"timezone":{"type":"string"}},"required":["output_format"]}`                                                                                                                                    |
| fmt_delivery_d_conditional | FORMAT    | program       | `{"type":"object","properties":{"when_d_equals":{"type":"string","default":"0"},"if_c_not_empty_output":{"type":"string","default":"00"},"if_c_empty_output":{"type":"string","default":""},"else_mode":{"type":"string","enum":["KEEP_ORIGINAL_D","EMPTY"],"default":"KEEP_ORIGINAL_D"}},"required":["when_d_equals"]}` |
| default_fixed_j            | FORMAT    | program       | `{"type":"object","properties":{"default_value":{"type":"string"}},"required":["default_value"]}`                                                                                                                                                                                                                        |
| default_fixed_k            | FORMAT    | program       | `{"type":"object","properties":{"default_value":{"type":"string"}},"required":["default_value"]}`                                                                                                                                                                                                                        |
| default_fixed_m            | FORMAT    | program       | `{"type":"object","properties":{"default_value":{"type":"string"}},"required":["default_value"]}`                                                                                                                                                                                                                        |
| default_to_col_a_if_empty  | CALC      | program       | `{"type":"object","properties":{"primary_col":{"type":"string","enum":["Q"]},"fallback_target_col":{"type":"string","enum":["A"]},"empty_values":{"type":"array","items":{"type":"string"},"default":["",null]}},"required":["primary_col","fallback_target_col"]}`                                                      |
| require_non_empty          | RULE_FIX  | program       | `{"type":"object","properties":{"error_code":{"type":"string","default":"REQUIRED"},"error_message":{"type":"string","default":"Field is required"},"block_on_fail":{"type":"boolean","default":true}},"required":["block_on_fail"]}`                                                                                    |
| const_empty                | CONST     | program       | `{"type":"object","properties":{"value":{"type":"string","default":""}},"required":["value"]}`                                                                                                                                                                                                                           |

> æ³¨ï¼š`default_fixed_j/k/m` æˆ‘æš‚æ—¶ç”¨ `rule_type=FORMAT` ä¹Ÿèƒ½è·‘ï¼ˆå› ä¸ºæ˜¯â€œå€¼å˜æ¢/å…œåº•â€ï¼‰ï¼Œå¦‚æœä½ æ›´å€¾å‘ä¸¥æ ¼è¯­ä¹‰ï¼Œä¹Ÿå¯ä»¥æŠŠè¿™ä¸‰æ¡æ”¹æˆ `rule_type=CONST` æˆ–æ–°å¢ `rule_type=DEFAULT`ï¼ˆä½†ä½ å½“å‰ rule_type æšä¸¾é‡Œæ²¡æœ‰ DEFAULTï¼Œæ‰€ä»¥æˆ‘æŒ‰â€œFORMAT è§„åˆ™åšå…œåº•â€æ¥è½ï¼‰ã€‚

---

## ä½ ç°åœ¨éœ€è¦ä½ ç¡®è®¤çš„ç‚¹ï¼ˆåªéœ€è¦ä¸€å¥è¯å›å¤å³å¯ï¼‰

1. **æ´¾é€åˆ—çš„çœŸå®è¡¨å¤´**ï¼šæ˜¯å¦å°±æ˜¯ A~Y çš„ä¸šåŠ¡åˆ—åï¼Ÿå¦‚æœæœ‰ï¼Œæˆ‘ä¸‹ä¸€æ­¥å°±æŠŠ `COL_A...COL_Y` å…¨æ›¿æ¢æˆçœŸå® header
2. `J/K/M` çš„é»˜è®¤å€¼ï¼ˆä½ è¯´â€œè¡¥å›ºå®šâ€ï¼Œä½†æ²¡ç»™å›ºå®šå€¼ï¼‰ï¼šå‘Šè¯‰æˆ‘ä¸‰ä¸ªé»˜è®¤å€¼ï¼Œæˆ‘å°±æŠŠ `default_value` å†™è¿›è§„åˆ™ï¼ˆæˆ–ä½ ä¹Ÿå¯ä»¥åé¢ç”±é…ç½®äººå‘˜åœ¨ Excel é‡Œå¡«ï¼‰

ä½ ç¡®è®¤åï¼Œæˆ‘å°±å¯ä»¥ç»§ç»­è¾“å‡ºä½ è¦çš„ä¸‹ä¸€ä»½ï¼š**æ´¾é€ Excel æ¨¡æ¿ï¼ˆ3ä¸ªsheetï¼‰+ MySQL insert è¯­å¥**ï¼ˆå®Œå…¨ä¸ä¸Šé¢å†…å®¹ä¸€è‡´ï¼‰ã€‚

ä¸‹é¢æŒ‰ä½ å·²å®šç‰ˆçš„é€»è¾‘ï¼ŒæŠŠ **æ¸…å…³æ–‡ä»¶ï¼ˆCustomsï¼‰æ–‡ä»¶ç±»å‹**çš„é…ç½®åšä¸€æ¬¡â€œæ€»ç»“çº§åˆ«â€çš„æ¢³ç†ï¼ˆå…ˆç»™äººçœ‹/è¯„å®¡ç”¨ï¼‰ï¼Œå¹¶æŠŠå®ƒæ˜ å°„åˆ°â€œä¸‰è¡¨æ¨¡å‹â€é‡Œè¯¥æ€ä¹ˆè½ï¼ˆä¸å±•å¼€åˆ°æ¯è¡Œé…ç½®æ˜ç»†ï¼Œç­‰ä½ è¯´â€œä»æ¸…å…³å¼€å§‹ç”Ÿæˆé…ç½®â€æˆ‘å†æŒ‰ä¸‰è¡¨è¾“å‡ºå…¨é‡ï¼‰ã€‚

---

# æ¸…å…³æ–‡ä»¶ï¼ˆCustomsï¼‰é…ç½®æ€»ç»“æ–‡æ¡£ï¼ˆv1ï¼‰

## 1) è¾“å…¥è¾“å‡º

* **è¾“å…¥ï¼ˆsourceï¼‰**ï¼šç”¨æˆ·ä¸Šä¼ çš„æ¸…å…³æº Excelï¼ˆ1 ä¸ª sheetï¼Œæš‚è®° `Customs`ï¼‰
* **è¾“å‡ºï¼ˆoutputï¼‰**ï¼šç³»ç»Ÿç”Ÿæˆçš„æ¸…å…³ç»“æœ Excelï¼ˆåŒ 1 ä¸ª sheetï¼Œ`Customs`ï¼‰
* ç³»ç»Ÿå†…éƒ¨å…è®¸å¤šæ­¥å¤„ç†ï¼Œä½†**é…ç½®å±‚åªå­˜åœ¨ source / output ä¸¤ä¸ªæ–‡ä»¶å®šä¹‰**ï¼ˆæ— ä¸­é—´æ–‡ä»¶å®ä½“ï¼‰

---

## 2) å­—æ®µå¤„ç†åˆ†ç»„ï¼ˆæŒ‰è¯­ä¹‰ç±»å‹å½’ç±»ï¼‰

### A. å›ºå®šå€¼ CONSTï¼ˆç›´æ¥å†™æ­»ï¼Œä¸ä¾èµ–æºåˆ—ï¼‰

å·²ç¡®è®¤å›ºå®šåˆ—ï¼š
**A / E / G / N / O / P / Q / S / T / V / AE / AF**

é…ç½®æ–¹å¼ï¼ˆfield_pipelinesï¼‰ï¼š

* `map_op = CONST`
* `field_type = CONST`
* `rule_ref = const_xxx`ï¼ˆæ¯åˆ—å¯å…±äº«åŒä¸€ä¸ª const è§„åˆ™ã€ç”¨å‚æ•°åŒºåˆ† valueï¼‰

---

### B. å¤åˆ¶ COPYï¼ˆæºâ†’ç›®æ ‡ä¸€å¯¹ä¸€æˆ–ç®€å•ç­‰å€¼ï¼‰

å·²ç¡®è®¤ï¼š

* **D = C**ï¼ˆå¤åˆ¶/ç­‰å€¼æ˜ å°„ï¼Œæºåˆ— C å†™åˆ°ç›®æ ‡åˆ— Dï¼‰

é…ç½®æ–¹å¼ï¼š

* D è¿™è¡Œï¼š`map_op=COPY`, `source_cols=["C"]`, `field_type=COPY`
* å¦‚æœä½ å¸Œæœ›â€œè¯­ä¹‰æ›´æ¸…æ™°â€ï¼Œä¹Ÿå¯å†™æˆ `field_type=CALC` + rule_ref=`copy_from_col`ï¼Œä½†æ²¡å¿…è¦

---

### C. è®¡ç®— CALCï¼ˆä¾èµ–å…¶ä»–åˆ—/å¤–éƒ¨æ¥å£ï¼‰

å·²ç¡®è®¤ï¼š

* **Bï¼šåºå·**ï¼ˆä» 1 è¿ç»­é€’å¢ï¼‰
* **Rï¼šå•ä»· = X Ã— å®æ—¶æ±‡ç‡ï¼ˆå¤–éƒ¨ APIï¼‰**

é…ç½®æ–¹å¼ï¼š

* Bï¼š`map_op=NONE`ï¼ˆæˆ– COPY ç©ºï¼‰ï¼Œ`field_type=CALC`, `rule_ref=["seq_from_1"]`
* Rï¼š`field_type=CALC`, `source_cols=["X"]`ï¼ˆä»¥åŠå¯èƒ½è¿˜è¦è´§å¸/å›½å®¶/æ—¥æœŸç­‰è¾“å…¥åˆ—ï¼‰ï¼Œ`rule_ref=["fx_convert_price"]`

  * `fx_convert_price` çš„ `executor_type` é€šå¸¸æ˜¯ `web`ï¼ˆè°ƒç”¨æ±‡ç‡æœåŠ¡ï¼‰æˆ– `program`ï¼ˆä½ ä»¬å†…éƒ¨æ±‡ç‡æœåŠ¡ SDKï¼‰

---

### D. AI å­—æ®µ AIï¼ˆå¤§æ¨¡å‹ç”Ÿæˆ/æ¨æ–­ï¼‰

å·²ç¡®è®¤ AI åˆ—ï¼š

* **Fï¼šè´§ç‰©é‡é‡ï¼ˆåŸºäº H/Iï¼‰**
* **Hï¼šå“åï¼ˆè‹±æ–‡åŒ–ï¼‰**
* **Iï¼šæè´¨ï¼ˆç¿»è¯‘ + æè´¨ç½®æ¢ï¼‰**
* **J/Kï¼šæ—¥â†’è‹± ç¿»è¯‘**
* **Xï¼šæ”¶ä»¶äººåï¼ˆæ—¥æ–‡æ¸…æ´—ï¼‰**
* **Yï¼šæ”¶ä»¶äººåœ°å€ï¼ˆæ—¥æ–‡ç”Ÿæˆ/åˆå¹¶ï¼‰**

é…ç½®æ–¹å¼ï¼š

* å¯¹åº”åˆ—ï¼š`field_type=AI`
* `executor_type=ai`
* `source_cols` å¡«ä¾èµ–è¾“å…¥åˆ—ï¼š

  * Fï¼š`["H","I"]`
  * Hï¼šå¯¹åº”æºå“ååˆ—ï¼ˆä½ ä»¬çœŸå®æºåˆ—ï¼‰
  * Iï¼šå¯¹åº”æºæè´¨åˆ—ï¼ˆä½ ä»¬çœŸå®æºåˆ—ï¼‰
  * J/Kï¼šå¯¹åº”æºæ—¥æ–‡æè¿°åˆ—
  * X/Yï¼šå¯¹åº”æºæ”¶ä»¶äººç›¸å…³åˆ—ï¼ˆå§“å/åœ°å€åˆ†æ®µç­‰ï¼‰

> å…³é”®ç‚¹ï¼šAI è§„åˆ™ schema_json é‡Œå¿…é¡»åŒ…å«ï¼šprompt æ¨¡æ¿ã€è¾“å‡ºçº¦æŸï¼ˆé•¿åº¦/å­—ç¬¦é›†/ç¦ç”¨ç¬¦å·ï¼‰ã€ç½®ä¿¡åº¦æˆ– fallback ç­–ç•¥ï¼ˆå¤±è´¥èµ° DEFAULT æˆ–é˜»æ–­ï¼‰ï¼Œä»¥åŠå®¡è®¡å­—æ®µï¼ˆæ¨¡å‹ã€ç‰ˆæœ¬ã€è¾“å…¥æ‘˜è¦ hashï¼‰ã€‚

---

### E. ç¨‹åºæ ¼å¼åŒ– FORMATï¼ˆä¸å¼•å…¥æ–°ä¿¡æ¯ï¼‰

å·²ç¡®è®¤ï¼š

* **L / M / Z / AA / ADï¼šå» '-'**
* **AB / ACï¼šå»æ‹¬å·**

é…ç½®æ–¹å¼ï¼š

* `field_type=FORMAT`
* `rule_ref=["remove_char_dash"]` æˆ– `["remove_chars", ...]`
* `rule_definitions` ä¸­ç»Ÿä¸€ç”¨ä¸€ä¸ªå¯å‚æ•°åŒ–è§„åˆ™ï¼ˆä¾‹å¦‚ `remove_chars`ï¼Œå‚æ•° `chars=["-"]`ã€`chars=["(",")"]`ï¼‰

---

### F. å¹³å°å­—æ®µ CALCï¼ˆæŸ¥æ‰¾æ˜ å°„ + é»˜è®¤ï¼‰

å·²ç¡®è®¤ï¼š

* **AGï¼šå¹³å°ç **ï¼ˆæ‰¾ä¸åˆ° â†’ é»˜è®¤ï¼‰
* **AHï¼šå¹³å°å**ï¼ˆç”± AG æ˜ å°„ï¼Œæ‰¾ä¸åˆ° â†’ é»˜è®¤ï¼‰

é…ç½®æ–¹å¼ï¼š

* AGï¼š`field_type=CALC`, `rule_ref=["lookup_platform_code_with_default"]`
* AHï¼š`field_type=CALC`, `depends_on=["AG"]`, `rule_ref=["map_platform_name_from_code_with_default"]`

> è¿™é‡Œ `rule_definitions` é‡Œé€šå¸¸éœ€è¦ä¸€ä¸ª `platform_mapping` çš„å‚æ•°æ¥æºï¼š
>
> * å†…ç½®æ˜ å°„è¡¨ï¼ˆjsonï¼‰/ DB è¡¨ / é…ç½®æ–‡ä»¶ï¼›å¹¶å¸¦ default_codeã€default_name

---

## 3) æ¸…å…³è§„åˆ™ç›®å½•ï¼ˆrule_definitionsï¼‰æœ€å°é›†åˆå»ºè®®

ä¸ºæ”¯æŒä¸Šè¿°é€»è¾‘ï¼Œæ¸…å…³è‡³å°‘ä¼šéœ€è¦è¿™äº› rule_refï¼ˆåç§°ä½ ä»¬å¯æ”¹ï¼Œä½†å»ºè®®è¯­ä¹‰ä¸€è‡´ï¼‰ï¼š

* `const_value`ï¼ˆCONSTï¼šå†™æ­» valueï¼‰
* `seq_from_1`ï¼ˆCALCï¼šåºå·ï¼‰
* `fx_convert_price`ï¼ˆCALC/WEBï¼šæ±‡ç‡æ¢ç®—ï¼‰
* `remove_chars`ï¼ˆFORMATï¼šåˆ é™¤æŒ‡å®šå­—ç¬¦é›†åˆï¼‰
* `ai_translate_ja_to_en`ï¼ˆAIï¼šæ—¥â†’è‹±ç¿»è¯‘ï¼‰
* `ai_material_translate_and_map`ï¼ˆAIï¼šæè´¨ç¿»è¯‘+ç½®æ¢ï¼‰
* `ai_goods_name_en`ï¼ˆAIï¼šå“åè‹±æ–‡åŒ–ï¼‰
* `ai_weight_infer`ï¼ˆAIï¼šé‡é‡æ¨æ–­ï¼‰
* `ai_receiver_name_clean_ja`ï¼ˆAIï¼šæ”¶ä»¶äººåæ¸…æ´—ï¼‰
* `ai_receiver_address_compose_ja`ï¼ˆAIï¼šåœ°å€åˆå¹¶ç”Ÿæˆï¼‰
* `lookup_platform_code_with_default`ï¼ˆCALCï¼šå¹³å°ç æŸ¥æ‰¾+é»˜è®¤ï¼‰
* `map_platform_name_from_code_with_default`ï¼ˆCALCï¼šå¹³å°åæ˜ å°„+é»˜è®¤ï¼‰

---

## 4) æ‰§è¡Œé¡ºåºï¼ˆfield_pipelines çš„ order/depends_onï¼‰

* å…ˆè·‘ï¼šCOPY / FORMATï¼ˆä¸ä¾èµ–ï¼‰
* å†è·‘ï¼šAIï¼ˆä¾èµ–æºåˆ—ï¼‰
* å†è·‘ï¼šCALCï¼ˆå°¤å…¶ä¾èµ– AI è¾“å‡ºçš„ï¼Œå¦‚ R ä¾èµ– Xï¼›AH ä¾èµ– AGï¼‰
* RULE_FIXï¼ˆå¦‚æœæœ‰é˜»æ–­æ ¡éªŒï¼‰å»ºè®®æ¯ä¸ªå…³é”®åˆ—è®¡ç®—åç«‹å³è·‘ï¼Œæˆ–æœ€åç»Ÿä¸€è·‘

---

# ä¸‹ä¸€æ­¥æ€ä¹ˆæ¥ï¼ˆä¸é—®ä½ é‡å¤ä¿¡æ¯ï¼‰

ä½ å¦‚æœåŒæ„ï¼Œæˆ‘ä»¬å°±æŒ‰ä½ ä¹‹å‰çš„èŠ‚å¥â€œä¸€æ¬¡ç¡®è®¤ä¸€ä¸ªâ€ï¼š

**ä½ ä¸‹ä¸€å¥ç›´æ¥å‘ï¼š**

> â€œä»ã€æ¸…å…³æ–‡ä»¶ã€‘å¼€å§‹ï¼Œç”Ÿæˆ file_definitionsï¼ˆä¸‰è¡¨æ¨¡å‹ç¬¬ä¸€å¼ è¡¨ï¼‰ã€‚â€

æˆ‘å°±ä¼šåƒæ´¾é€é‚£æ ·ï¼Œè¾“å‡ºæ¸…å…³çš„ï¼š

1. è¯´æ˜æ–‡æ¡£ï¼ˆæ›´ç»†ä¸€ç‚¹åˆ°åˆ—çº§åˆ«ï¼‰
2. file_definitions é…ç½®å†…å®¹ï¼ˆsource+outputï¼‰
3. å¯¹åº” SQL insertï¼ˆMySQLï¼‰

ç„¶åä½ ç¡®è®¤åï¼Œå†ç»§ç»­æ¸…å…³çš„ field_pipelinesï¼ˆå…¨åˆ—ï¼‰ä¸ rule_definitionsï¼ˆå…¨è§„åˆ™ï¼‰ã€‚

ä¸‹é¢ç›´æ¥ç»™å‡º **ã€æ¸…å…³æ–‡ä»¶ Customsã€‘çš„ file_definitionsï¼ˆç¬¬ä¸€å¼ è¡¨ï¼‰**ï¼šåŒ…å«**è¯´æ˜** + **é…ç½®è¡Œï¼ˆsource/output å„ä¸€æ¡ï¼‰** + **MySQL å¯å¯¼å…¥ insert**ã€‚
ï¼ˆè¡¨å¤´åä½ è¿˜æ²¡ç»™ï¼Œæˆ‘å…ˆç”¨ `COL_A â€¦ COL_AH` å ä½ï¼›åç»­ä½ ç»™çœŸå®è¡¨å¤´ï¼Œæˆ‘å†ä¸€é”®æ›¿æ¢ï¼Œä¸å½±å“å¼•æ“ç»“æ„ã€‚ï¼‰

---

# 1) file_definitions è¯´æ˜ï¼ˆCustomsï¼‰

**ç›®çš„**ï¼šå®šä¹‰â€œæ¸…å…³æ–‡ä»¶é•¿ä»€ä¹ˆæ ·â€ï¼ˆsource / outputï¼‰ã€Sheetã€è¡¨å¤´è¡Œã€æ•°æ®èµ·å§‹è¡Œï¼Œä»¥åŠåˆ—é›†åˆï¼ˆAâ€¦AHï¼‰ä¸åˆ—å¤´åç§°ã€‚
**èŒƒå›´**ï¼šä»…æ¸…å…³æ–‡ä»¶ç±»å‹ `CUSTOMS`ï¼›ä¸æ¶‰åŠå­—æ®µæ˜ å°„ä¸è§„åˆ™ï¼ˆé‚£æ˜¯ field_pipelines / rule_definitionsï¼‰ã€‚

**é»˜è®¤å‡è®¾ï¼ˆå¯æ”¹ï¼‰**

* `sheet_name = "Customs"`
* `header_row = 1`
* `data_start_row = 2`
* åˆ—èŒƒå›´ï¼š**Aâ€“AH**ï¼ˆä½ åœ¨ä¸Šä¸‹æ–‡æ˜ç¡®æåˆ°æ¸…å…³åˆ° AHï¼‰

---

# 2) file_definitions é…ç½®å†…å®¹ï¼ˆ2 è¡Œï¼‰

å»ºè®®è¡¨å­—æ®µï¼ˆä¸ä½ ä¸‰è¡¨æ¨¡å‹ä¸€è‡´çš„â€œæ–‡ä»¶å®šä¹‰è¡¨â€è¯­ä¹‰ï¼‰ï¼š

* `file_type`ï¼šCUSTOMS
* `file_role`ï¼šsource / output
* `sheet_name`
* `header_row`
* `data_start_row`
* `columns_json`ï¼šåˆ—æ¸…å• + header å

> columns_json é‡Œæˆ‘ç»™äº† Aâ€“AH å…¨åˆ—ï¼Œå ä½ headerï¼š`COL_A ... COL_AH`

| file_type | file_role | sheet_name | header_row | data_start_row | columns_json                                                                                                                                            |
| --------- | --------- | ---------- | ---------: | -------------: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| CUSTOMS   | source    | Customs    |          1 |              2 | `[{"col":"A","header":"COL_A"},{"col":"B","header":"COL_B"},{"col":"C","header":"COL_C"},{"col":"D","header":"COL_D"},{"col":"E","header":"COL_E"},{"col":"F","header":"COL_F"},{"col":"G","header":"COL_G"},{"col":"H","header":"COL_H"},{"col":"I","header":"COL_I"},{"col":"J","header":"COL_J"},{"col":"K","header":"COL_K"},{"col":"L","header":"COL_L"},{"col":"M","header":"COL_M"},{"col":"N","header":"COL_N"},{"col":"O","header":"COL_O"},{"col":"P","header":"COL_P"},{"col":"Q","header":"COL_Q"},{"col":"R","header":"COL_R"},{"col":"S","header":"COL_S"},{"col":"T","header":"COL_T"},{"col":"U","header":"COL_U"},{"col":"V","header":"COL_V"},{"col":"W","header":"COL_W"},{"col":"X","header":"COL_X"},{"col":"Y","header":"COL_Y"},{"col":"Z","header":"COL_Z"},{"col":"AA","header":"COL_AA"},{"col":"AB","header":"COL_AB"},{"col":"AC","header":"COL_AC"},{"col":"AD","header":"COL_AD"},{"col":"AE","header":"COL_AE"},{"col":"AF","header":"COL_AF"},{"col":"AG","header":"COL_AG"},{"col":"AH","header":"COL_AH"}]` |
| CUSTOMS   | output    | Customs    |          1 |              2 | `[{"col":"A","header":"COL_A"},{"col":"B","header":"COL_B"},{"col":"C","header":"COL_C"},{"col":"D","header":"COL_D"},{"col":"E","header":"COL_E"},{"col":"F","header":"COL_F"},{"col":"G","header":"COL_G"},{"col":"H","header":"COL_H"},{"col":"I","header":"COL_I"},{"col":"J","header":"COL_J"},{"col":"K","header":"COL_K"},{"col":"L","header":"COL_L"},{"col":"M","header":"COL_M"},{"col":"N","header":"COL_N"},{"col":"O","header":"COL_O"},{"col":"P","header":"COL_P"},{"col":"Q","header":"COL_Q"},{"col":"R","header":"COL_R"},{"col":"S","header":"COL_S"},{"col":"T","header":"COL_T"},{"col":"U","header":"COL_U"},{"col":"V","header":"COL_V"},{"col":"W","header":"COL_W"},{"col":"X","header":"COL_X"},{"col":"Y","header":"COL_Y"},{"col":"Z","header":"COL_Z"},{"col":"AA","header":"COL_AA"},{"col":"AB","header":"COL_AB"},{"col":"AC","header":"COL_AC"},{"col":"AD","header":"COL_AD"},{"col":"AE","header":"COL_AE"},{"col":"AF","header":"COL_AF"},{"col":"AG","header":"COL_AG"},{"col":"AH","header":"COL_AH"}]` |

---

# 3) MySQL insertï¼ˆå¯ç›´æ¥å¯¼å…¥ï¼‰

> å‡è®¾ä½ ä»¬è¡¨åå°±å« `file_definitions`ï¼Œå­—æ®µå¦‚ä¸‹ï¼š
> `file_type, file_role, sheet_name, header_row, data_start_row, columns_json`
> ï¼ˆå¦‚ä½ ä»¬çœŸå®å­—æ®µåä¸åŒï¼Œä½ æŠŠå­—æ®µåç»™æˆ‘ï¼Œæˆ‘ç«‹åˆ»æ”¹æˆå®Œå…¨åŒ¹é…ç‰ˆã€‚ï¼‰

```sql
INSERT INTO file_definitions
(file_type, file_role, sheet_name, header_row, data_start_row, columns_json)
VALUES
(
  'CUSTOMS',
  'source',
  'Customs',
  1,
  2,
  '[{"col":"A","header":"COL_A"},{"col":"B","header":"COL_B"},{"col":"C","header":"COL_C"},{"col":"D","header":"COL_D"},{"col":"E","header":"COL_E"},{"col":"F","header":"COL_F"},{"col":"G","header":"COL_G"},{"col":"H","header":"COL_H"},{"col":"I","header":"COL_I"},{"col":"J","header":"COL_J"},{"col":"K","header":"COL_K"},{"col":"L","header":"COL_L"},{"col":"M","header":"COL_M"},{"col":"N","header":"COL_N"},{"col":"O","header":"COL_O"},{"col":"P","header":"COL_P"},{"col":"Q","header":"COL_Q"},{"col":"R","header":"COL_R"},{"col":"S","header":"COL_S"},{"col":"T","header":"COL_T"},{"col":"U","header":"COL_U"},{"col":"V","header":"COL_V"},{"col":"W","header":"COL_W"},{"col":"X","header":"COL_X"},{"col":"Y","header":"COL_Y"},{"col":"Z","header":"COL_Z"},{"col":"AA","header":"COL_AA"},{"col":"AB","header":"COL_AB"},{"col":"AC","header":"COL_AC"},{"col":"AD","header":"COL_AD"},{"col":"AE","header":"COL_AE"},{"col":"AF","header":"COL_AF"},{"col":"AG","header":"COL_AG"},{"col":"AH","header":"COL_AH"}]'
),
(
  'CUSTOMS',
  'output',
  'Customs',
  1,
  2,
  '[{"col":"A","header":"COL_A"},{"col":"B","header":"COL_B"},{"col":"C","header":"COL_C"},{"col":"D","header":"COL_D"},{"col":"E","header":"COL_E"},{"col":"F","header":"COL_F"},{"col":"G","header":"COL_G"},{"col":"H","header":"COL_H"},{"col":"I","header":"COL_I"},{"col":"J","header":"COL_J"},{"col":"K","header":"COL_K"},{"col":"L","header":"COL_L"},{"col":"M","header":"COL_M"},{"col":"N","header":"COL_N"},{"col":"O","header":"COL_O"},{"col":"P","header":"COL_P"},{"col":"Q","header":"COL_Q"},{"col":"R","header":"COL_R"},{"col":"S","header":"COL_S"},{"col":"T","header":"COL_T"},{"col":"U","header":"COL_U"},{"col":"V","header":"COL_V"},{"col":"W","header":"COL_W"},{"col":"X","header":"COL_X"},{"col":"Y","header":"COL_Y"},{"col":"Z","header":"COL_Z"},{"col":"AA","header":"COL_AA"},{"col":"AB","header":"COL_AB"},{"col":"AC","header":"COL_AC"},{"col":"AD","header":"COL_AD"},{"col":"AE","header":"COL_AE"},{"col":"AF","header":"COL_AF"},{"col":"AG","header":"COL_AG"},{"col":"AH","header":"COL_AH"}]'
);
```

---

## ä½ ç¡®è®¤ç‚¹ï¼ˆåªè¦å›ä¸€å¥â€œOK/æ”¹è¿™é‡Œâ€ï¼‰

* Sheet åæ˜¯å¦å°±æ˜¯ `Customs`ï¼Ÿï¼ˆæœ‰äº›å®¢æˆ·ä¼šå« `Sheet1` æˆ– `æ¸…å…³`ï¼‰
* header/data èµ·å§‹è¡Œæ˜¯å¦ `1/2`ï¼Ÿ

ä½ ç¡®è®¤åï¼Œæˆ‘å°±ç»§ç»­è¾“å‡º **æ¸…å…³çš„ç¬¬äºŒå¼ è¡¨ï¼šfield_pipelinesï¼ˆå…¨åˆ—æ‰§è¡Œè®¡åˆ’ï¼‰**ã€‚
